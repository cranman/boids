<!doctype html>
<html>
	<head>
		<title>Boids</title>

		<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>

		<script type="text/javascript">
			$(document).ready(function() {
				var boids = [];

				var ctx;

				// Initialise positions of boids
				function init() {
					ctx = $('#canvas')[0].getContext('2d');

					makeBoids(10);

//					setInterval(loop, 10);
loop();
				}

				function makeBoids(num) {
					for(var i = 0; i < num; i++) {
						var x = Math.floor(Math.random()*600);
						var y = Math.floor(Math.random()*600);
						var dx = Math.floor(Math.random()*10 - 5);
						var dy = Math.floor(Math.random()*10 - 5);

						boids.push(new Boid(x, y, dx, dy));
					}
				}

				// Main loop
				function loop() {
					draw();
					update();
				}

				function draw() {
					for (var i = 0; i < boids.length; i++) {
						boids[i].draw();
					}
				}

				function update() {
					var v1, v2, v3;

					for (var i = 0; i < boids.length; i++) {

//						v1 = rule1(b);
//						v2 = rule2(b);
//						v3 = rule3(b);
//
//						boids[i].dx += v1.x + v2.dx + v3.dx;
//						boids[i].dy += v1.y + v2.dy = v3.dy;
//						boids[i].x += boids[i].x + boids[i].dx;
//						boids[i].y += boids[i].y + boids[i].dy;
					}
				}

				// Boids try to fly towards the centre of mass of neighbouring boids
				function rule1(b) {
					var v = { 
						x : 0, 
						y : 0
					};

					for (var i = 0; i < boids.length; i++) {
						if (b == i ) {
							continue;
						}

						v.x += boids[i].x;
						v.y += boids[i].y;
					}

					v.x /= boids.length - 1;
					v.y /= boids.length - 1;

					v.x = (v.x - boids[b].x)/100;
					v.y = (v.y - boids[b].y)/100;

					return v;
				}

				// Boid object
				function Boid(x, y, dx, dy) {
					this.x = x;
					this.y = y;
					this.dx = dx;
					this.dy = dy;
				}

				Boid.prototype.draw = function() {
					ctx.beginPath();
					ctx.arc(this.x, this.y, 5, 0, Math.PI*2);
					ctx.closePath();
					ctx.fill();
				}

				init();
			});
		</script>
	</head>
	<body>
		<canvas id="canvas" width="600" height="600"></canvas>
	</body>
</html>
